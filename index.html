<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width; initial-scale=1.0">
<title>Sambun</title>
</head>
<body>
    <ul>
        <li>
            <h2>1</h2>
            <ul>
                <li><input type="checkbox" name="s" data-name="ㅈㅅ1" data-color="적" data-country="위" data-type="검">ㅈㅅ1</li>
                <li><input type="checkbox" name="s" data-name="ㅈㅅ2" data-color="청" data-country="위" data-type="창">ㅈㅅ2</li>
                <li><input type="checkbox" name="s" data-name="ㅈㅅ3" data-color="적" data-country="위" data-type="특">ㅈㅅ3</li>
                <li><input type="checkbox" name="s" data-name="ㅈㅅ4" data-color="적" data-country="위" data-type="책">ㅈㅅ4</li>
                <li><input type="checkbox" name="s" data-name="ㅈㅅ5" data-color="황" data-country="위" data-type="검">ㅈㅅ5</li>
                <li><input type="checkbox" name="s" data-name="ㅈㅅ6" data-color="적" data-country="위" data-type="창">ㅈㅅ6</li>
                <li><input type="checkbox" name="s" data-name="ㅈㅅ7" data-color="적" data-country="위" data-type="특">ㅈㅅ7</li>
            </ul>
        </li>
    </ul>

    <div class="result">
        <h3>ㅅㅌㄷ ㅈㅅ</h3>
        <ul class="type1">
        </ul>
        <h3>ㅍㅅㅎㄱ</h3>
        <ul class="type2">
        </ul>
    </div>

    <script>
        class set{
            constructor(){
                this.default_color_organiztion_txt = [
                    '청 3개 효과',
                    '청 4개 효과',
                    '적 3개 효과',
                    '적 4개 효과',
                    '황 3개 효과',
                    '황 4개 효과'
                ];
                
                this.select_Btn = document.querySelectorAll('input');

                this.result_member_txt = document.querySelector('.type1');
                this.result_organization_txt = document.querySelector('.type2');

                this.select_member = [];
                this.select_color_organization = [];

                this.current_select_member = undefined;
                
                this.color_blue = 0;
                this.color_red = 0;
                this.color_yellow = 0;

                this.country_wei = 0;
                this.country_shu = 0;
                this.country_wo = 0;

                this.type_sword = 0;
                this.type_lance = 0;
                this.type_special = 0;
                this.type_deceit = 0;
            }

            mount(){
                let _self = this;
                this.select_Btn.forEach((_e)=>{
                    _e.addEventListener('click', function(){
                                
                        let selectTarget = {
                            name : this.getAttribute('data-name'),
                            color : this.getAttribute('data-color'),
                            country : this.getAttribute('data-country'),
                            type : this.getAttribute('data-type')
                        }
                        
                        _self.current_select_member = selectTarget;

                        if(this.checked) {
                            if(_self.select_member.length <= 5){
                                _self._add_Event();
                                _self.select_member.push(selectTarget);
                            }else{
                                alert('max 6');
                                this.checked = false;
                            }
                        }else{
                            _self._del_color();
                            let _idx = _self.select_member.findIndex(function(item) {return item.name === selectTarget.name});
                            //console.log(_idx);
                            _self.select_member.splice(_idx, 1);
                            //console.log(_self.select_member);
                        }
                        //_self._organization();
                    });    
                });
            }

            _add_Event(){
                this._add_color();
                
                // switch(this.current_select_member.country){
                //     case '위' :
                //         this.country_wei++;
                //         break;
                //     case '촉' :
                //         this.country_shu++;
                //         break;
                //     case '오' :
                //         this.country_wo++;
                //         break;
                // }
                
                // switch(this.current_select_member.type){
                //     case '검' :
                //         this.type_sword++;
                //         break;
                //     case '창' :
                //         this.type_lance++;
                //         break;
                //     case '특' :
                //         this.type_special++;
                //         break;
                //     case '책' :
                //         this.type_deceit++;
                //         break;
                // }

                // console.log('"""""""""""""');
                // console.log('청 : ' +  this.color_blue);
                // console.log('적 : ' +  this.color_red);
                // console.log('황 : ' +  this.color_yellow);
            }

            _del_color(){
                const current_color_organization = this._color_check();

                switch(this.current_select_member.color){
                    case '청' :
                        this.color_blue--;
                        break;
                    case '적' :
                        this.color_red--;
                        break;
                    case '황' :
                        this.color_yellow--;
                        break;
                }

                if(current_color_organization != undefined){
                    let _idx = this.select_color_organization.indexOf(current_color_organization);

                    if(_idx != -1){
                        console.log('있음 - 삭제완료');
                        this.select_color_organization.splice(_idx, 1);
                        console.log(this.select_color_organization);
                        this.result_organization_txt.querySelectorAll('li').forEach((_e, _i)=>{
                            if(_e.textContent == current_color_organization){
                                _e.remove();
                            }
                        });
                    }else{
                        console.log('없음 - 추가조건 아님');
                    }
                }
            }

            _add_color(){

                switch(this.current_select_member.color){
                    case '청' :
                        this.color_blue++;
                        break;
                    case '적' :
                        this.color_red++;
                        break;
                    case '황' :
                        this.color_yellow++;
                        break;
                }

                const new_color_organization = this._color_check();

                if(new_color_organization != undefined){
                    let _idx = this.select_color_organization.indexOf(new_color_organization);

                    if(_idx == -1){
                        console.log('없음 - 추가완료');
                        this.select_color_organization.push(new_color_organization);
                        console.log(this.select_color_organization);

                        let _a = document.createElement('li'),
                            _a_t = document.createTextNode(new_color_organization);
                            
                        _a.appendChild(_a_t);
                        this.result_organization_txt.appendChild(_a);
                            console.log(new_color_organization + ' 효과 적용');
                    }else{
                        console.log('있음 - 삭제조건 아님');
                    }
                }
            }
            
            _color_check(){
                let result_txt = undefined;
                
                if(this.color_blue >= 3){
                    if(this.color_blue >= 4){
                        result_txt = this.default_color_organiztion_txt[2]; 
                    }else{
                        result_txt = this.default_color_organiztion_txt[1];
                    }
                }

                if(this.color_red >= 3){
                    if(this.color_red >= 4){
                        result_txt = this.default_color_organiztion_txt[4];
                    }else{
                        result_txt = this.default_color_organiztion_txt[3];
                    }
                }

                if(this.color_yellow >= 3){
                    if(this.color_yellow >= 4){
                        result_txt = this.default_color_organiztion_txt[6];
                    }else{
                        result_txt = this.default_color_organiztion_txt[5];
                    }
                }

                return result_txt;
            }


        }


        new set().mount();
    </script>
</body>
</html>